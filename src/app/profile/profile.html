<mat-card class="profile-card mat-elevation-z6">
  <mat-card-header>
    <mat-card-title>
      <h2>User Profile</h2>
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form (ngSubmit)="saveProfile()" #profileForm="ngForm">
      <div class="profile-grid">
        <div class="profile-section">
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>First Name</mat-label>
            <input matInput [(ngModel)]="currentUser()!.firstName" name="firstName" required>
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Last Name</mat-label>
            <input matInput [(ngModel)]="currentUser()!.lastName" name="lastName" required>
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Email</mat-label>
            <input matInput [value]="currentUser()!.email" disabled>
          </mat-form-field>
        </div>

        <div class="profile-section">
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Phone</mat-label>
            <input matInput [(ngModel)]="currentUser()!.phone" name="phone">
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100" *ngIf="toys().length > 0">
            <mat-label>Favourite Toy</mat-label>
            <mat-select [(ngModel)]="currentUser()!.toy" name="toy">
              <mat-option *ngFor="let t of toys()" [value]="t">
                {{ t }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field appearance="fill" class="w-100">
            <mat-label>Address</mat-label>
            <input matInput [(ngModel)]="currentUser()!.address" name="address">
          </mat-form-field>
        </div>
      </div>

      <div class="text-center mt-3">
        <button mat-raised-button color="accent" [disabled]="!profileForm.form.valid">
          <mat-icon>save</mat-icon> Save Changes
        </button>
      </div>
    </form>
    <mat-divider class="my-4"></mat-divider>
    <h3>Change Password</h3>
    <form (ngSubmit)="changePassword()" #passwordForm="ngForm">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Current Password</mat-label>
        <input matInput type="password" [(ngModel)]="currentPassword" name="currentPassword" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="w-100">
        <mat-label>New Password</mat-label>
        <input matInput type="password" [(ngModel)]="newPassword" name="newPassword" required>
      </mat-form-field>

      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Confirm New Password</mat-label>
        <input matInput type="password" [(ngModel)]="confirmPassword" name="confirmPassword" required>
      </mat-form-field>

      <div class="text-center mt-2">
        <button mat-raised-button color="primary"
          [disabled]="!passwordForm.form.valid || newPassword !== confirmPassword">
          <mat-icon>lock</mat-icon> Change Password
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>